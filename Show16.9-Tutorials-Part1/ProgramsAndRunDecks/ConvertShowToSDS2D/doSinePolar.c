#include <stdio.h>#include <math.h>#include "showlib.h"/*    gcc -O3 -o doSinePolar doSinePolar.c showlib.c*/static showPtr show;#define EMAX4 5000000Lstatic long *elem4;static long nelem4;#define Max_Nodes 1000000Lstatic double *x,*y,*z,*v;static long nn,ne;static long nodes;int doTestSine(void);char *cMalloc(unsigned long length);int cFree(char *message);int main(){	int ret;	ret=1;	elem4=(long *)cMalloc(EMAX4*sizeof(long));	if(!elem4){	   printf("No Element Memory\n");	   return 1;	}		x=(double *)cMalloc(Max_Nodes*sizeof(double));	if(!x){	   printf("No x Memory\n");	   return 1;	}		y=(double *)cMalloc(Max_Nodes*sizeof(double));	if(!y){	   printf("No y Memory\n");	   return 1;	}		z=(double *)cMalloc(Max_Nodes*sizeof(double));	if(!z){	   printf("No z Memory\n");	   return 1;	}			v=(double *)cMalloc(Max_Nodes*sizeof(double));	if(!v){	   printf("No v Memory\n");	   return 1;	}			show=showStart("Image.shw","w");	if(!show)return 1;		nodes=0;	nelem4=0;		if(doTestSine())goto ErrorOut;		nn=nodes;	ne=nelem4/5;		printf("nodes %ld Quads %ld\n",nodes,ne);		if(nn > 0 && ne > 0){		    ret=showNodes(show,nn,x,y,z);	    if(ret)goto ErrorOut;	    ret=showValues(show,nn,v);	    if(ret)goto ErrorOut;        ret=showElements(show,ne,4L,elem4);	    if(ret)goto ErrorOut;		    ret=showEnd(show);	    if(ret)goto ErrorOut;		}	ret=0;	ErrorOut:		showDone(show);		return ret;		}int doTestSine(void){	double r,s,xx,yy,xc,yc,range,theta,dr,dt,sintheta,costheta;	int i,j;	long nn;	long NXY;	int ret;		ret=1;			nodes=0;		NXY=400;				xc=10.;	yc=10.;		dr=10./((double)NXY-1.0);	theta=0;	dt=360./((double)NXY-1.0);	dt *= (3.1415926/180.);	nn=0;	for(j=0;j<NXY;++j){	    sintheta=sin(theta);	    costheta=cos(theta);	    theta += dt;	    range=0;	    for(i=0;i<NXY;++i){	        xx=xc+range*costheta;	        yy=yc+range*sintheta;	        range += dr;	        r=sqrt((xc-xx)*(xc-xx)+(yc-yy)*(yc-yy));      		if(r == 0.){      		    s=10.;      		}else{ 				s=10*sin(r)/(r);      		}      		        if(nodes+1 >= Max_Nodes){	            fprintf(stderr,"doTestSine Out of Node Space %ld EMAX4 %ld\n",nodes,Max_Nodes);	            goto ErrorOut;	        }      		v[nodes]=(double)(s);      		z[nodes]=(double)(s);      		y[nodes]=(double)yy;      		x[nodes]=(double)xx;      		++nodes;      		    }	} 			nelem4=0;	for(j=0;j<NXY-1;++j){	    for(i=0;i<NXY-1;++i){	        if(nelem4+5 >= EMAX4){	            fprintf(stderr,"doTestSine Out of Element Space %ld EMAX4 %ld\n",nelem4,EMAX4);	            goto ErrorOut;	        }			elem4[nelem4]=1;			++nelem4;			elem4[nelem4]=i+j*NXY;			++nelem4;			elem4[nelem4]=i+1+j*NXY;			++nelem4;			elem4[nelem4]=i+1+(j+1)*NXY;			++nelem4;			elem4[nelem4]=i+(j+1)*NXY;			++nelem4;	    }	}			ret=0;	ErrorOut:	return ret;}